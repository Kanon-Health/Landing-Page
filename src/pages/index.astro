---
import Layout from '~/layouts/Layout.astro';
// Import logo URL for CSS masking
import kanonLogo from '~/assets/images/kanon-logo.svg';

const metadata = {
  title: 'Kanon Care',
};
---

<Layout metadata={metadata}>
  <section id="hero-section" class="relative min-h-[100dvh] flex flex-col items-center justify-center overflow-hidden bg-[#010409] text-slate-200">
    
    <div class="absolute inset-0 z-0 pointer-events-none">
      <div class="absolute inset-0 opacity-[0.12]" 
           style="background-image: linear-gradient(#1e293b 1px, transparent 1px), linear-gradient(90deg, #1e293b 1px, transparent 1px); background-size: 60px 60px;">
      </div>
      
      <div class="absolute top-[-10%] left-[-10%] w-[80%] h-[80%] bg-cyan-500/25 rounded-full blur-[120px] animate-mesh-1"></div>
      <div class="absolute bottom-[-10%] right-[-10%] w-[80%] h-[80%] bg-blue-600/25 rounded-full blur-[120px] animate-mesh-2"></div>
      <div class="absolute top-1/4 left-1/4 w-[50%] h-[50%] bg-indigo-500/20 rounded-full blur-[100px] animate-mesh-3"></div>
      
      <div class="absolute inset-0 bg-radial-vignette"></div>
    </div>

    <main class="relative z-10 text-center px-6 max-w-5xl mx-auto flex flex-col items-center">
      
      <div class="flex flex-row items-center justify-center gap-4 md:gap-8 mb-6">
        
        <div 
          class="w-16 h-16 md:w-24 md:h-24 bg-gradient-to-b from-white via-white to-slate-500 drop-shadow-[0_0_15px_rgba(6,182,212,0.6)]"
          style={`
            mask-image: url(${kanonLogo.src});
            mask-size: contain;
            mask-repeat: no-repeat;
            mask-position: center;
            -webkit-mask-image: url(${kanonLogo.src});
            -webkit-mask-size: contain;
            -webkit-mask-repeat: no-repeat;
            -webkit-mask-position: center;
          `}
        ></div>

        <h1 class="text-7xl md:text-9xl font-extrabold tracking-tighter leading-[0.85] bg-gradient-to-b from-white via-white to-slate-500 bg-clip-text text-transparent drop-shadow-2xl">
          KANON
        </h1>
      </div>
      
      <p class="text-xl md:text-2xl text-cyan-400 font-semibold mb-4 tracking-wide uppercase">
        AI-Assisted Care. Audit-Ready Workflows.
      </p>

      <p class="max-w-2xl mx-auto text-slate-400 text-lg mb-12 leading-relaxed">
        Built for home health owners who demand audit safety and care teams who deserve a better workflow. 
        A modern EMR designed to eliminate administrative friction and secure your agency's future.
      </p>

      <div class="flex flex-col sm:flex-row gap-6 justify-center items-center">
        <button id="open-modal" class="px-10 py-4 bg-white text-black font-bold rounded-full hover:scale-105 transition-all shadow-lg shadow-white/10 cursor-pointer">
          Request Early Access
        </button>
        
        <div class="px-6 py-3 border border-slate-800 rounded-full text-slate-400 text-sm flex items-center gap-3 bg-slate-900/50">
          <span class="flex h-2 w-2 rounded-full bg-cyan-500 animate-pulse shadow-[0_0_10px_#06b6d4]"></span>
          Now in Alpha
        </div>
      </div>
    </main>

    <footer class="absolute bottom-0 w-full z-10 pb-6 px-6 text-center max-w-3xl mx-auto">
      <p class="text-slate-600 text-[10px] tracking-widest uppercase mb-4">
        &copy; 2026 Kanon Health • 
        <a href="/privacy" class="hover:text-cyan-500 transition-colors">Privacy</a> • 
        <a href="/terms" class="hover:text-cyan-500 transition-colors">Terms</a> • 
        Info: 
        <a 
          href="mailto:info&#64;kanoncare&#46;health?subject=General&#32;Inquiry" 
          class="text-cyan-500 hover:text-cyan-400 underline decoration-cyan-500/30 underline-offset-4 transition-colors"
        >
          info&#64;kanoncare&#46;health
        </a>
      </p>
      <p class="text-slate-500 text-[10px] leading-relaxed opacity-40 select-none">
        Disclaimer: Kanon is a documentation and workflow tool designed to support regulatory compliance. Use of Kanon does not guarantee audit success or immunity from regulatory findings. Agencies remain solely responsible for their clinical, administrative, and regulatory compliance.
      </p>
    </footer>
  </section>

  <div id="modal-overlay" class="fixed inset-0 z-50 hidden items-center justify-center bg-slate-950/80 backdrop-blur-sm p-4">
    <div class="bg-slate-900 border border-slate-800 w-full max-w-md p-8 rounded-3xl shadow-2xl relative overflow-hidden">
      <button id="close-modal" class="absolute top-4 right-4 text-slate-500 hover:text-white text-2xl px-2">&times;</button>
      
      <div id="form-content">
        <h2 class="text-2xl font-bold mb-2 text-white">Join the Waitlist</h2>
        <p class="text-slate-400 mb-6 text-sm">Be the first to see how Kanon streamlines your workflow.</p>
        <form id="waitlist-form" class="space-y-4 text-left">
          <input type="text" name="name" required placeholder="Full Name" class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 focus:outline-none focus:border-cyan-500 transition-all">
          <input type="email" name="email" required placeholder="Email Address" class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 focus:outline-none focus:border-cyan-500 transition-all">
          <input type="text" name="role" required placeholder="Role (e.g. CEO)" class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 focus:outline-none focus:border-cyan-500 transition-all">
          <input type="text" name="company" required placeholder="Agency Name" class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 focus:outline-none focus:border-cyan-500 transition-all">
          <button type="submit" id="submit-btn" class="w-full py-4 bg-cyan-600 hover:bg-cyan-500 text-white font-bold rounded-xl transition-all">
            Secure Early Access
          </button>
        </form>
      </div>

      <div id="success-content" class="hidden text-center py-8">
        <div class="w-20 h-20 bg-cyan-500/20 text-cyan-500 rounded-full flex items-center justify-center mx-auto mb-6">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" />
          </svg>
        </div>
        <h2 class="text-2xl font-bold mb-2 text-white">You're on the list!</h2>
        <p class="text-slate-400 mb-8 text-sm">We'll be in touch shortly regarding your alpha access.</p>
        <button id="success-close" class="w-full py-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-all">Done</button>
      </div>
    </div>
  </div>

  <style is:global>
    @keyframes mesh-1 {
      0% { transform: translate(0, 0) scale(1); }
      50% { transform: translate(15%, 10%) scale(1.1); }
      100% { transform: translate(0, 0) scale(1); }
    }
    @keyframes mesh-2 {
      0% { transform: translate(0, 0) scale(1.1); }
      50% { transform: translate(-15%, -10%) scale(0.9); }
      100% { transform: translate(0, 0) scale(1.1); }
    }
    @keyframes mesh-3 {
      0% { transform: translate(0, 0); opacity: 0.15; }
      50% { transform: translate(10%, -10%); opacity: 0.3; }
      100% { transform: translate(0, 0); opacity: 0.15; }
    }
    .animate-mesh-1 { animation: mesh-1 18s ease-in-out infinite; }
    .animate-mesh-2 { animation: mesh-2 22s ease-in-out infinite; }
    .animate-mesh-3 { animation: mesh-3 15s ease-in-out infinite; }
    
    .bg-radial-vignette { 
      background: radial-gradient(circle at center, transparent 40%, #010409 100%); 
    }
  </style>

  <script is:inline src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script is:inline>
    const openBtn = document.getElementById('open-modal');
    const closeBtn = document.getElementById('close-modal');
    const overlay = document.getElementById('modal-overlay');
    const form = document.getElementById('waitlist-form');
    const submitBtn = document.getElementById('submit-btn');
    const formContent = document.getElementById('form-content');
    const successContent = document.getElementById('success-content');
    const successClose = document.getElementById('success-close');

    const toggleModal = (show) => {
      if (show) {
        overlay.classList.remove('hidden');
        overlay.classList.add('flex');
      } else {
        overlay.classList.add('hidden');
        overlay.classList.remove('flex');
        setTimeout(() => { 
          formContent.classList.remove('hidden'); 
          successContent.classList.add('hidden'); 
          form.reset(); 
        }, 300);
      }
    };

    openBtn.addEventListener('click', () => toggleModal(true));
    closeBtn.addEventListener('click', () => toggleModal(false));
    successClose.addEventListener('click', () => toggleModal(false));
    overlay.addEventListener('click', (e) => { if (e.target === overlay) toggleModal(false); });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const originalText = submitBtn.innerText;
      submitBtn.innerText = 'Syncing...';
      submitBtn.disabled = true;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      try {
        const response = await fetch('https://capturelead-701766541051.us-east1.run.app', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
        });
        if (response.ok) {
          formContent.classList.add('hidden');
          successContent.classList.remove('hidden');
          confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#06b6d4', '#ffffff'] });
        } else {
          alert('Submission failed.');
          submitBtn.innerText = originalText;
          submitBtn.disabled = false;
        }
      } catch {
        alert('Error.');
        submitBtn.innerText = originalText;
        submitBtn.disabled = false;
      }
    });
  </script>
</Layout>